(function(a){function e(e){for(var s,n,o=e[0],c=e[1],l=e[2],h=0,_=[];h<o.length;h++)n=o[h],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&_.push(r[n][0]),r[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(a[s]=c[s]);d&&d(e);while(_.length)_.shift()();return i.push.apply(i,l||[]),t()}function t(){for(var a,e=0;e<i.length;e++){for(var t=i[e],s=!0,o=1;o<t.length;o++){var c=t[o];0!==r[c]&&(s=!1)}s&&(i.splice(e--,1),a=n(n.s=t[0]))}return a}var s={},r={app:0},i=[];function n(e){if(s[e])return s[e].exports;var t=s[e]={i:e,l:!1,exports:{}};return a[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=a,n.c=s,n.d=function(a,e,t){n.o(a,e)||Object.defineProperty(a,e,{enumerable:!0,get:t})},n.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},n.t=function(a,e){if(1&e&&(a=n(a)),8&e)return a;if(4&e&&"object"===typeof a&&a&&a.__esModule)return a;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:a}),2&e&&"string"!=typeof a)for(var s in a)n.d(t,s,function(e){return a[e]}.bind(null,s));return t},n.n=function(a){var e=a&&a.__esModule?function(){return a["default"]}:function(){return a};return n.d(e,"a",e),e},n.o=function(a,e){return Object.prototype.hasOwnProperty.call(a,e)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var d=c;i.push([0,"chunk-vendors"]),t()})({0:function(a,e,t){a.exports=t("56d7")},"2c7f":function(a,e,t){},"3bfe":function(a,e,t){},4656:function(a,e,t){"use strict";var s=t("f8ac"),r=t.n(s);r.a},5436:function(a,e,t){"use strict";var s=t("b3ce"),r=t.n(s);r.a},"56d7":function(a,e,t){"use strict";t.r(e);t("a133"),t("ed0d"),t("f09c"),t("e117");var s=t("0261"),r=t("1bee"),i=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("router-view")},n=[],o={},c=o,l=t("9ca4"),d=Object(l["a"])(c,i,n,!1,null,null,null),h=d.exports,_=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"wrapper",staticStyle:{height:"780px",width:"100% !important"}},[t("side-bar"),t("top-navbar"),t("dashboard-content")],1)},u=[],p=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("md-toolbar",{staticClass:"md-transparent",staticStyle:{overflow:"hidden","border-bottom":"1px #252525 solid","background-color":"#010101 !important",height:"70px",padding:"0 0"},attrs:{"md-elevation":"0"}},[t("div",{staticClass:"md-toolbar-row"},[t("div",{staticClass:"md-toolbar-section-start"},[t("tabs",{attrs:{tabs:a.tabs,currentTab:a.currentTab,"wrapper-class":"default-tabs","tab-class":"default-tabs__item","tab-active-class":"default-tabs__item_active","line-class":"default-tabs__active-line"},on:{onClick:a.handleClick}})],1),t("div",{staticClass:"md-toolbar-section-end"},[t("md-list",[t("button",{staticClass:"download-button",on:{click:a.save_current_model}},[t("i",{staticClass:"material-icons",staticStyle:{"margin-left":"10px !important","margin-top":"8px"}},[a._v("cloud_download")]),t("div",{staticStyle:{"margin-top":"-2px","margin-left":"15px"}},[a._v(" Download Model ")])])])],1)])])},m=[],v=new s["default"]({data:{current_drawing_tools:"tool-arrow",current_stroke_width:3,current_model:{version:"0.1.0",comment:"Generated by MeshLab JSON Exporter",id:1,name:"mesh",vertices:[{name:"position_buffer",size:3,type:"float32",normalized:!1,values:[-.25,-.25,-.25,.25,-.25,-.25,-.25,.25,-.25,.25,.25,-.25,-.25,-.25,.25,.25,-.25,.25,-.25,.25,.25,.25,.25,.25]},{name:"normal_buffer",size:3,type:"float32",normalized:!1,values:[-.57735,-.57735,-.57735,.333333,-.666667,-.666667,-.666667,.333333,-.666667,.666667,.666667,-.333333,-.666667,-.666667,.333333,.666667,-.333333,.666667,-.333333,.666667,.666667,.57735,.57735,.57735]}],connectivity:[{name:"triangles",mode:"triangles_list",indexed:!0,indexType:"uint32",indices:[2,1,0,1,2,3,4,2,0,2,4,6,1,4,0,4,1,5,6,5,7,5,6,4,3,6,7,6,3,2,5,3,7,3,5,1]}],mapping:[{name:"standard",primitives:"triangles",attributes:[{source:"position_buffer",semantic:"position",set:0},{source:"normal_buffer",semantic:"normal",set:0}]}],custom:null}}}),f=t("8401"),g=[{title:"Sketch",value:"Sketch"},{title:"Preview",value:"Preview"}],y={components:{Tabs:f["a"]},data:function(){return{selectedEmployee:null,employees:[],tabs:g,currentTab:"Sketch",displayType:[{name:"Sketch",activated:!0},{name:"Preview",activated:!1}]}},methods:{askCopyCurrentLayer:function(){v.$emit("update:askPasteCurrentLayer")},askChangeViewType:function(){v.$emit("update:askChangeViewType")},askAssembly:function(){v.$emit("update:askAssembly")},toggleSidebar:function(){this.$sidebar.displaySidebar(!this.$sidebar.showSidebar)},clear_current_layer:function(){v.$emit("update:clearChairLayer")},add_new_layer:function(){v.$emit("update:addChairLayer")},delete_current_layer:function(){v.$emit("update:deleteChairLayer")},save_current_model:function(){v.$emit("save:current:model")},handleClick:function(a){this.currentTab=a,v.$emit("update:changeviewtype",a)}},mounted:function(){var a=this;v.$on("hack:header",(function(){a.$data.currentTab="Preview"}))}},$=y,b=(t("d903"),Object(l["a"])($,p,m,!1,null,null,null)),w=b.exports,L=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("footer",{staticClass:"footer"},[t("div",{staticClass:"container"},[a._m(0),t("div",{staticClass:"copyright text-center"},[a._v(" Â© "+a._s((new Date).getFullYear())+" "),t("a",{attrs:{href:"https://www.creative-tim.com/?ref=mdf-vuejs",target:"_blank"}},[a._v("Creative Tim")]),a._v(", made with "),t("i",{staticClass:"fa fa-heart heart"}),a._v(" for a better web ")])])])},x=[function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("nav",[t("ul",[t("li",[t("a",{attrs:{href:"https://www.creative-tim.com"}},[a._v("Creative Tim")])]),t("li",[t("a",{attrs:{href:"https://creative-tim.com/presentation"}},[a._v(" About Us ")])]),t("li",[t("a",{attrs:{href:"http://blog.creative-tim.com"}},[a._v(" Blog ")])]),t("li",[t("a",{attrs:{href:"https://www.creative-tim.com/license"}},[a._v(" Licenses ")])])])])}],k={},C=k,S=Object(l["a"])(C,L,x,!1,null,null,null),T=S.exports,E=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("transition",{attrs:{name:"fade",mode:"out-in"}},[t("router-view")],1)},D=[],O={},M=O,A=(t("5436"),Object(l["a"])(M,E,D,!1,null,null,null)),H=A.exports,I=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("ul",{staticClass:"nav nav-mobile-menu"},[t("li",[t("md-field",[t("label",[a._v("Search")]),t("md-input",{attrs:{type:"text"},model:{value:a.search,callback:function(e){a.search=e},expression:"search"}})],1)],1),a._m(0),t("li",[t("drop-down",[t("a",{staticClass:"dropdown-toggle",attrs:{slot:"title","data-toggle":"dropdown"},slot:"title"},[t("i",{staticClass:"material-icons"},[a._v("notifications")]),t("span",{staticClass:"notification"},[a._v("5")]),t("p",[a._v("Notifications")])]),t("ul",{staticClass:"dropdown-menu dropdown-menu-right"},[t("li",[t("a",{attrs:{href:"#"}},[a._v("Mike John responded to your email")])]),t("li",[t("a",{attrs:{href:"#"}},[a._v("You have 5 new tasks")])]),t("li",[t("a",{attrs:{href:"#"}},[a._v("You're now friend with Andrew")])]),t("li",[t("a",{attrs:{href:"#"}},[a._v("Another Notification")])]),t("li",[t("a",{attrs:{href:"#"}},[a._v("Another One")])])])])],1),a._m(1)])},N=[function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("li",[t("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"}},[t("i",{staticClass:"material-icons"},[a._v("dashboard")]),t("p",[a._v("Dashboard")])])])},function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("li",[t("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"}},[t("i",{staticClass:"material-icons"},[a._v("person")]),t("p",[a._v("Profile")])])])}],j={data:function(){return{search:null,selectedEmployee:null,employees:["Jim Halpert","Dwight Schrute","Michael Scott","Pam Beesly","Angela Martin","Kelly Kapoor","Ryan Howard","Kevin Malone"]}}},P=j,R=Object(l["a"])(P,I,N,!1,null,null,null),U=R.exports,z=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:a.closeDropDown,expression:"closeDropDown"}],staticClass:"fixed-plugin"},[t("div",{staticClass:"dropdown show-dropdown",class:{show:a.isOpen}},[t("a",{attrs:{"data-toggle":"dropdown"}},[t("i",{class:""+a.selectedTools[a.currentToolId].iconName,staticStyle:{color:"#dfdfdf !important","padding-top":"8px","padding-bottom":"10px"},on:{click:a.toggleDropDown}})]),t("ul",{staticClass:"dropdown-menu",class:{show:a.isOpen}},[t("li",{staticClass:"header-title"},[a._v("Drawing Tools")]),t("li",{staticClass:"adjustments-line text-center",staticStyle:{height:"50px !important","margin-top":"0px"}},a._l(a.selectedTools,(function(e){return t("span",{key:e.type,staticClass:"badge filter",class:["badge-"+e.color,{active:e.active}],staticStyle:{width:"40px",height:"40px"},on:{click:function(t){return a.changeDrawingTools(e.type)}}},[t("i",{class:""+e.iconName,staticStyle:{"margin-top":"3px"}})])})),0),t("li",{staticClass:"header-title"},[a._v("Stroke Width ("+a._s(a.strokeWidth)+")")]),t("li",{staticClass:"adjustments-line text-center",staticStyle:{"margin-bottom":"10px"}},[t("vue-slider",a._b({ref:"slider",staticStyle:{width:"80%","margin-left":"25px","margin-top":"0px"},attrs:{min:1,max:10,interval:1,marks:!0},model:{value:a.strokeWidth,callback:function(e){a.strokeWidth=e},expression:"strokeWidth"}},"vue-slider",a.sliderOptions,!1))],1)])])])},W=[],B=t("b96d"),K=t.n(B),V=(t("e1174"),t("ac61")),F=t.n(V),J=t("3d4b");t("e3c3");s["default"].use(F.a),s["default"].use(J["a"],{useCache:!0});var Y={components:{vueSlider:K.a},data:function(){return{isOpen:!1,strokeWidth:4,currentToolId:0,selectedTools:[{type:"tool-arrow",active:!0,iconName:"fa fa-mouse-pointer fa-2x"},{type:"tool-brush",active:!1,iconName:"fa fa-paint-brush fa-2x"},{type:"tool-eraser",active:!1,iconName:"fa fa-eraser fa-2x"}],sliderOptions:{stepStyle:void 0}}},watch:{strokeWidth:function(a,e){v.$data.current_stroke_width=a,v.$emit("update:strokeWidth",a)}},methods:{toggleDropDown:function(){this.isOpen=!this.isOpen},closeDropDown:function(){this.isOpen=!1},toggleList:function(a,e){},updateValue:function(a,e){console.log(a),this.$emit("update:".concat(a),e)},changeSidebarBackground:function(a){this.$emit("update:color",a.color),this.toggleList(this.sidebarColors,a)},changeDrawingTools:function(a){for(var e=0;e<this.selectedTools.length;e++)this.selectedTools[e].type===a?(this.selectedTools[e].active=!0,this.$data.currentToolId=e):this.selectedTools[e].active=!1;v.$data.current_drawing_tools=a,v.$emit("update:drawingtools",a)}},mounted:function(){var a=this;v.$on("hack:updatebrush",(function(){a.$data.currentToolId=0,a.selectedTools[0].active=!0,a.selectedTools[1].active=!1,a.selectedTools[2].active=!1,v.$data.current_drawing_tools="tool-arrow",a.$forceUpdate()}))}},q=Y,G=(t("dac3"),Object(l["a"])(q,z,W,!1,null,null,null)),X=G.exports,Z={components:{TopNavbar:w,DashboardContent:H,ContentFooter:T,MobileMenu:U,FixedPlugin:X},data:function(){return{}}},Q=Z,aa=Object(l["a"])(Q,_,u,!1,null,null,null),ea=aa.exports,ta=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticStyle:{display:"flex","padding-top":"0px","margin-bottom":"0px",height:"100% !important","padding-bottom":"0px",background:"#121417","margin-left":"70px"}},[t("div",{staticClass:"canvascol",staticStyle:{flex:"1 1 auto"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:a.show_sketch,expression:"show_sketch"}],staticClass:"maincanvas",staticStyle:{height:"512px",width:"512px","border-style":"dashed","border-width":"2px","border-color":"#495057"},attrs:{id:"maincanvas"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:a.show_preview,expression:"show_preview"}],staticClass:"threecanvas",staticStyle:{height:"512px",width:"512px","border-style":"dashed","border-width":"2px","border-color":"#495057"},attrs:{id:"threecanvas"}})]),t("div",{staticClass:"previecol",staticStyle:{flex:"0 0 340px","background-color":"#010101","border-left":"1px solid #252729"}},[t("div",{staticStyle:{height:"200px","margin-top":"10px","margin-left":"30px","margin-right":"30px"}},[t("p",{staticStyle:{"font-size":"16px","font-weight":"bold",color:"white"}},[a._v("Model Type")]),t("el-dropdown",[t("el-button",{staticStyle:{width:"300px","margin-left":"40px","margin-top":"10px","background-color":"rgb(17,109,247)","border-width":"0px","font-size":"16px"},attrs:{type:"primary"}},[a._v(" "+a._s(a.current_type)+" "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{staticStyle:{width:"300px","background-color":"rgb(19,23,27)"},attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{staticStyle:{color:"gray"},nativeOn:{click:function(e){return a.change_current_type("Chair")}}},[a._v("Chair")]),t("el-dropdown-item",{staticStyle:{color:"gray"},nativeOn:{click:function(e){return a.change_current_type("Lamp")}}},[a._v("Lamp")]),t("el-dropdown-item",{staticStyle:{color:"gray"},nativeOn:{click:function(e){return a.change_current_type("Table")}}},[a._v("Table")])],1)],1),t("p",{staticStyle:{"font-size":"16px","font-weight":"bold",color:"white","margin-top":"30px"}},[a._v("Part Preview")]),t("div",{staticStyle:{"scroll-behavior":"smooth","background-color":"rgb(19,23,27)","margin-right":"0px",height:"580px","max-height":"580px",overflow:"scroll","border-radius":"5px","scrollbar-width":"0px"},attrs:{id:"previewlist"}},a._l(a.canvasLayers,(function(e){return t("md-card",{key:e.id,staticStyle:{"background-color":"rgb(19,23,27)","border-style":"dashed","border-width":"0px","border-color":"#495057",width:"382px",height:"180px",margin:"auto","margin-left":"0px","margin-right":"5px","margin-top":"4px","margin-bottom":"2px"}},[t("div",{staticStyle:{height:"170px",width:"384px"}},[t("div",{staticStyle:{"margin-top":"3px","margin-left":"1px",width:"30px",height:"50px",display:"inline-block","vertical-align":"top"}},[t("i",{staticClass:"fa fa-eye",class:e.visable?"layer-visable":"layer-notvisable",staticStyle:{"margin-left":"3px","padding-left":"2px","padding-right":"2px","padding-top":"2px",height:"22px","border-style":"solid","border-width":"2px","border-color":"#495057",position:"relative"},on:{click:function(t){return a.change_visable_status(e.id)}}}),t("i",{staticClass:"fa fa-paint-brush",class:e.activated?"layer-activated":"layer-notactivated",staticStyle:{"margin-left":"3px","margin-top":"4px","padding-left":"3px","padding-right":"3px","padding-top":"2px",height:"22px","border-style":"solid","border-width":"2px","border-color":"#495057",position:"relative"},on:{click:function(t){return a.change_activate_status(e.id)}}})]),t("div",{staticStyle:{"background-color":"white","border-radius":"2px","vertical-align":"top",top:"0px","margin-top":"3px","margin-left":"0px",width:"170px",height:"170px",display:"inline-block",position:"relative","border-style":"solid","border-width":"1px","border-color":"#495057"},attrs:{id:e.previewId}}),t("div",{staticStyle:{"border-radius":"2px","vertical-align":"top",top:"0px","margin-top":"3px","margin-left":"3px",width:"170px",height:"170px",display:"inline-block",position:"relative","border-style":"solid","border-width":"1px","border-color":"#495057"},attrs:{id:e.previewModelId}})])])})),1)],1)]),t("my-upload",{attrs:{field:"img",width:512,height:512,params:a.params,headers:a.headers,"img-format":"png"},on:{"crop-success":a.cropSuccess,"crop-upload-success":a.cropUploadSuccess,"crop-upload-fail":a.cropUploadFail},model:{value:a.show_image_uploader,callback:function(e){a.show_image_uploader=e},expression:"show_image_uploader"}})],1)},sa=[],ra=(t("7ae7"),t("09ee"),t("af82"),t("c1f4"),t("c1b0"),t("3a20"),t("b3f9"),t("7267"),t("ef8e"),t("3e5e"),t("9a14"),t("252a"),t("8f0e"),t("52ef")),ia=t("a14a"),na=t.n(ia),oa=(t("9f45"),t("663a")),ca=t("bf8a"),la=t("551d"),da=t("8eb2"),ha=t("10d9"),_a=t("bdd6")(la),ua=new _a,pa=t("5f22")(la),ma=t("e450")(la);new da["PLYExporter"];window.Three=la;var va={el:"#app",components:{ModelObj:ca["ModelObj"],dropdown:ha["a"],"my-upload":oa["a"]},data:function(){return{view_mode:-1,cur_brush_width:5,cur_brush_type:"tool-arrow",current_type:"Chair",show_image_uploader:!1,imgDataUrl:"",mesh_color:1351880,mesh_spec:1118481,params:{token:"123456798",name:"avatar"},headers:{smail:"*_~"},canvasLayers:[{id:0,items:[],activated:!0,layer:-1,transHandle:-1,visable:!0,previewStage:-1,previewLayer:-1,previewId:"preview-0",previewModelId:"preview-model-0",needsUpdate:!1,current_3d_info:{cur_renderer:-1,cur_scene:-1,cur_mesh:-1,cur_scene_camera:-1,cur_scene_control:-1,cur_vox_info:-1}}],show_sketch:!0,show_preview:!1,assemble_head_text:"Show The Assembled Model",assemble_head_color_type:"background:#448aff;height:60px;",download_link:-1,assemble_transform_controls:-1,assemble_mouse:-1,assemble_recaster:-1,selected_part_to_transform:null,currentLayerId:0,canvas_height:512,canvas_width:512,preview_height:170,preview_width:170,global_stage:-1,is_painting:!1,biggest_id:0,global_3d_info:{cur_renderer:-1,cur_scene:-1,cur_mesh:-1,cur_scene_camera:-1,cur_scene_control:-1,cur_mesh_string:-1},assemble_mesh_part_list:[],INTERSECTED:null,layer_to_copy_id:null,current_fps:30,current_time:0,three_clock:-1}},methods:{load_image_to_current_layer:function(){for(var a=-1,e=0;e<this.$data.canvasLayers.length;e++)1==this.$data.canvasLayers[e].activated&&(a=e);if(-1!=a&&""!=this.$data.imgDataUrl){var t=new Konva.Image({width:512,height:512,draggable:!1}),s=new Image;s.src=this.$data.imgDataUrl,t.image(s),this.$data.canvasLayers[a].items.push(t),this.$data.canvasLayers[a].layer.add(this.$data.canvasLayers[a].items[this.$data.canvasLayers[a].items.length-1]),this.$data.canvasLayers[a].needsUpdate=!0;var r=na.a.debounce(this.update_part_sketch_models,200);this.redraw_visable_layers(),this.redraw_preview_layers(),r()}},cropSuccess:function(a,e){console.log("-------- crop success --------"),this.$data.imgDataUrl=a,this.load_image_to_current_layer()},cropUploadSuccess:function(a,e){},cropUploadFail:function(a,e){},change_current_type:function(a){var e=this;this.$data.current_type!=a&&this.$axios({method:"post",baseURL:"http://localhost:11451",url:"/changeModelType",crossDomain:!0,header:{"Access-Control-Allow-Origin":!0},data:{modelType:a}}).then((function(t){e.$data.current_type=a})).catch((function(a){return console.log(a,"error")}))},synBusProps:function(){this.$data.cur_brush_width=v.$data.current_stroke_width,this.$data.cur_brush_type=v.$data.current_drawing_tools},change_activate_status:function(a){for(var e=-1,t=0;t<this.$data.canvasLayers.length;t++)a==this.$data.canvasLayers[t].id&&(e=t);if(-1!=e)for(var s=0;s<this.$data.canvasLayers.length;s++)this.$data.canvasLayers[s].activated=s==e;this.clearTransHandles(),this.updateTransHandles(),this.redraw_visable_layers()},change_visable_status:function(a){for(var e=-1,t=0;t<this.$data.canvasLayers.length;t++)a==this.$data.canvasLayers[t].id&&(e=t);-1!=e&&(this.$data.canvasLayers[e].visable=!this.$data.canvasLayers[e].visable,1==this.$data.canvasLayers[e].visable?this.$data.canvasLayers[e].layer.show():this.$data.canvasLayers[e].layer.hide()),this.clearTransHandles(),this.updateTransHandles(),this.redraw_visable_layers()},change_type_option:function(a){this.$data.selected_object=a},clear_canvas_dom:function(){var a=document.getElementById("maincanvas");this.$data.global_stage=-1,a.querySelectorAll("*").length>0&&a.querySelectorAll("*").forEach((function(a){return a.remove()}))},change_canvas_icon_type:function(){this.$data.global_stage},redraw_visable_layers:function(){for(var a=0;a<this.$data.canvasLayers.length;a++)if(1!=!this.$data.canvasLayers[a].visable){if(this.$data.canvasLayers[a].activated){var e,t=Object(ra["a"])(this.$data.canvasLayers[a].layer.getChildren());try{for(t.s();!(e=t.n()).done;){var s=e.value;s.opacity(1)}}catch(o){t.e(o)}finally{t.f()}}else{var r,i=Object(ra["a"])(this.$data.canvasLayers[a].layer.getChildren());try{for(i.s();!(r=i.n()).done;){var n=r.value;"source-over"==n.globalCompositeOperation()&&n.opacity(.3)}}catch(o){i.e(o)}finally{i.f()}}this.$data.canvasLayers[a].layer.batchDraw()}},clear_current_layer:function(){if(!this.$data.show_preview){for(var a=-1,e=0;e<this.$data.canvasLayers.length;e++)1==this.$data.canvasLayers[e].activated&&(a=e);if(-1!=a){this.$data.canvasLayers[a].items=[],this.$data.canvasLayers[a].layer.destroyChildren(),this.$data.canvasLayers[a].transHandle=-1,this.$data.canvasLayers[a].needsUpdate=!1,this.$data.canvasLayers[a].current_3d_info.cur_mesh=-1;var t=new la["DirectionalLight"](16777215,1.35);t.position.set(1,1,1),this.$data.canvasLayers[a].current_3d_info.cur_scene=new la["Scene"],this.$data.canvasLayers[a].current_3d_info.cur_scene.add(t),this.$data.canvasLayers[a].current_3d_info.cur_scene.add(new la["HemisphereLight"](4469555,1118498)),this.$data.canvasLayers[a].transHandle=new Konva.Transformer({keepRatio:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"]}),this.$data.canvasLayers[a].layer.add(this.$data.canvasLayers[a].transHandle)}}},check_preview:function(){for(var a=0;a<this.$data.canvasLayers.length;a++)-1==this.$data.canvasLayers[a].previewStage&&(this.$data.canvasLayers[a].previewStage=new Konva.Stage({container:"preview-"+this.$data.canvasLayers[a].id,width:this.$data.preview_width,height:this.$data.preview_height,scaleX:this.$data.preview_width/this.$data.canvas_width,scaleY:this.$data.preview_height/this.$data.canvas_height}))},check_model_preview:function(){for(var a=0;a<this.$data.canvasLayers.length;a++)if(-1==this.$data.canvasLayers[a].current_3d_info.cur_renderer){var e=document.getElementById("preview-model-"+this.$data.canvasLayers[a].id);this.$data.canvasLayers[a].current_3d_info.cur_scene_camera=new la["PerspectiveCamera"](70,e.clientWidth/e.clientHeight,.01,10),this.$data.canvasLayers[a].current_3d_info.cur_scene_camera.position.z=1,this.$data.canvasLayers[a].current_3d_info.cur_scene=new la["Scene"],this.$data.canvasLayers[a].current_3d_info.cur_renderer=new la["WebGLRenderer"]({antialias:!0}),this.$data.canvasLayers[a].current_3d_info.cur_renderer.setSize(e.clientWidth,e.clientHeight),this.$data.canvasLayers[a].current_3d_info.cur_renderer.setClearColor(16777215,1),this.$data.canvasLayers[a].current_3d_info.cur_scene_control=new pa(this.$data.canvasLayers[a].current_3d_info.cur_scene_camera,this.$data.canvasLayers[a].current_3d_info.cur_renderer.domElement),this.$data.canvasLayers[a].current_3d_info.cur_scene_control.rotateSpeed=1,this.$data.canvasLayers[a].current_3d_info.cur_scene_control.zoomSpeed=1.2,this.$data.canvasLayers[a].current_3d_info.cur_scene_control.panSpeed=.8,this.$data.canvasLayers[a].current_3d_info.cur_scene_control.enabled=!0,this.$data.canvasLayers[a].current_3d_info.cur_scene_control.enableRotate=!0,this.$data.canvasLayers[a].current_3d_info.cur_scene_control.enableZoom=!0,e.appendChild(this.$data.canvasLayers[a].current_3d_info.cur_renderer.domElement)}},add_new_layer:function(){var a=this;if(!this.$data.show_preview){for(var e=0;e<this.$data.canvasLayers.length;e++)this.$data.canvasLayers[e].activated=!1;this.$data.canvasLayers.push({id:this.$data.biggest_id+1,items:[],activated:!0,layer:-1,visable:!0,previewStage:-1,needsUpdate:!1,previewModelId:"preview-model-"+(this.$data.biggest_id+1),previewId:"preview-"+(this.$data.biggest_id+1),current_3d_info:{cur_renderer:-1,cur_scene:-1,cur_mesh:-1,cur_scene_camera:-1,cur_scene_control:-1,cur_vox_info:-1}});for(var t=170,s=580,r=10,i=0;i<this.$data.canvasLayers.length-2;i++)this.$data.canvasLayers[i].activated=!1;this.$data.canvasLayers[this.$data.canvasLayers.length-1].layer=new Konva.Layer({id:"chair_"+this.$data.canvasLayers[this.$data.canvasLayers.length-1].id.toString()}),this.$data.biggest_id=this.$data.biggest_id+1,this.$data.canvasLayers[this.$data.canvasLayers.length-1].transHandle=new Konva.Transformer({keepRatio:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"]}),this.$data.global_stage.add(this.$data.canvasLayers[this.$data.canvasLayers.length-1].layer),this.$data.canvasLayers.length>3&&this.$nextTick((function(){console.log("ask scroll top");var e=document.querySelector("#previewlist"),i=(e.scrollTop,a.$data.canvasLayers.length*t+r-s+t);e.scrollTop=i}))}},remove_current_layer:function(){if(!(this.$data.canvasLayers.length<=1)&&!this.$data.show_preview){for(var a=-1,e=0;e<this.$data.canvasLayers.length;e++)1==this.$data.canvasLayers[e].activated&&(a=e);-1!=a&&(this.$data.canvasLayers[a].items=[],this.$data.canvasLayers[a].layer.destroyChildren()),this.$data.global_stage.find("#chair_"+this.$data.canvasLayers[a].id.toString()).destroy(),a>=1?this.$data.canvasLayers[a-1].activated=!0:this.$data.canvasLayers[a+1].activated=!0,this.$data.canvasLayers.splice(a,1)}},clearTransHandles:function(){for(var a=0;a<this.$data.canvasLayers.length;a++)this.$data.canvasLayers[a].transHandle.nodes([]);this.$data.global_stage.find("Transformer").remove()},updateTransHandles:function(){for(var a=-1,e=0;e<this.$data.canvasLayers.length;e++)1==this.$data.canvasLayers[e].activated&&(a=e);if(-1!=a){for(var t=0;t<this.$data.canvasLayers.length;t++)for(var s=0;s<this.$data.canvasLayers[t].items.length;s++)t==a&&"tool-arrow"==this.$data.cur_brush_type?(this.$data.canvasLayers[t].items[s].draggable(!0),this.$data.canvasLayers[t].items[s].listening(!0)):(this.$data.canvasLayers[t].items[s].draggable(!1),this.$data.canvasLayers[t].items[s].listening(!1));this.$data.canvasLayers[a].transHandle.nodes(this.$data.canvasLayers[a].items),this.$data.canvasLayers[a].layer.add(this.$data.canvasLayers[a].transHandle)}},inner_add_new_layer:function(){var a=this;this.add_new_layer(),this.clearTransHandles(),"tool-arrow"==v.current_drawing_tools&&this.updateTransHandles(),this.$nextTick((function(){a.check_preview(),a.check_model_preview(),a.redraw_visable_layers()}))},copy_sketch_current_layers:function(){if(!this.$data.show_preview&&null!=this.$data.layer_to_copy_id){for(var a=-1,e=0;e<this.$data.canvasLayers.length;e++)1==this.$data.canvasLayers[e].activated&&(a=e);for(var t=0;t<this.$data.canvasLayers[this.$data.layer_to_copy_id].items.length;t++)this.$data.canvasLayers[a].items.push(this.$data.canvasLayers[this.$data.layer_to_copy_id].items[t].clone({x:10,y:10,draggable:!1})),this.$data.canvasLayers[a].layer.add(this.$data.canvasLayers[a].items[t]);this.$data.canvasLayers[a].current_3d_info.cur_mesh=this.$data.canvasLayers[this.$data.layer_to_copy_id].current_3d_info.cur_mesh.clone(),this.$data.canvasLayers[a].current_3d_info.cur_scene.add(this.$data.canvasLayers[a].current_3d_info.cur_mesh);var s=new la["DirectionalLight"](16777215,1.35);s.position.set(1,1,1),this.$data.canvasLayers[a].current_3d_info.cur_scene.add(s),this.$data.canvasLayers[a].current_3d_info.cur_scene.add(new la["HemisphereLight"](4469555,1118498)),this.$data.canvasLayers[a].current_3d_info.cur_vox_info=this.$data.canvasLayers[this.$data.layer_to_copy_id].current_3d_info.cur_vox_info,this.$data.layer_to_copy_id=null}},copy_current_layer:function(){var a=this;console.log("copy current layer");for(var e=-1,t=0;t<this.$data.canvasLayers.length;t++)1==this.$data.canvasLayers[t].activated&&(e=t);this.$data.layer_to_copy_id=e,this.add_new_layer(),this.clearTransHandles(),"tool-arrow"==v.current_drawing_tools&&this.updateTransHandles(),this.$nextTick((function(){a.check_preview(),a.check_model_preview(),a.copy_sketch_current_layers(),a.redraw_visable_layers(),a.update_part_sketch_models(),a.redraw_preview_layers(),v.$emit("hack:updatebrush","tool-arrow"),a.synBusProps(),a.updateTransHandles()}))},inner_remove_layer:function(){this.remove_current_layer(),this.clearTransHandles(),"tool-arrow"==v.current_drawing_tools&&this.updateTransHandles(),this.redraw_visable_layers()},redraw_preview_layers:function(){for(var a=0;a<this.$data.canvasLayers.length;a++){-1==!this.$data.canvasLayers[a].previewLayer&&this.$data.canvasLayers[a].previewLayer.destroy(),this.$data.canvasLayers[a].previewStage.destroyChildren(),this.$data.canvasLayers[a].previewLayer=this.$data.canvasLayers[a].layer.clone({hitGraphEnabled:!1}),this.$data.canvasLayers[a].previewLayer.show();var e,t=Object(ra["a"])(this.$data.canvasLayers[a].previewLayer.getChildren());try{for(t.s();!(e=t.n()).done;){var s=e.value;s.opacity(1)}}catch(r){t.e(r)}finally{t.f()}this.$data.canvasLayers[a].previewStage.add(this.$data.canvasLayers[a].previewLayer),this.$data.canvasLayers[a].previewLayer.batchDraw()}},redraw_global_scene:function(){requestAnimationFrame(this.redraw_global_scene);var a=this.$data.three_clock.getDelta();this.$data.current_time=this.$data.current_time+a;var e=1/this.$data.current_fps;if(this.$data.current_time>e){this.$data.global_3d_info.cur_scene_control.update();for(var t=0;t<this.$data.canvasLayers.length;t++)-1!=this.$data.canvasLayers[t].current_3d_info.cur_scene_control&&(this.$data.canvasLayers[t].current_3d_info.cur_scene_control.update(),this.$data.canvasLayers[t].current_3d_info.cur_renderer.render(this.$data.canvasLayers[t].current_3d_info.cur_scene,this.$data.canvasLayers[t].current_3d_info.cur_scene_camera));if(1==this.$data.view_mode){this.$data.assemble_recaster.setFromCamera(this.$data.assemble_mouse,this.$data.global_3d_info.cur_scene_camera);var s=this.$data.assemble_recaster.intersectObjects(this.$data.global_3d_info.cur_scene.children);s.length>0?this.$data.INTERSECTED!=s[0].object&&(this.$data.INTERSECTED&&this.$data.INTERSECTED.material.emissive.setHex(this.$data.INTERSECTED.currentHex),this.$data.INTERSECTED=s[0].object,this.$data.INTERSECTED.currentHex=this.$data.INTERSECTED.material.emissive.getHex(),this.$data.INTERSECTED.material.emissive.setHex(16711680)):this.$data.INTERSECTED&&(this.$data.INTERSECTED.material.emissive.setHex(this.$data.INTERSECTED.currentHex),this.$data.INTERSECTED=null)}this.$data.global_3d_info.cur_renderer.render(this.$data.global_3d_info.cur_scene,this.$data.global_3d_info.cur_scene_camera),this.$data.current_time=0}},assemble_parts:function(){for(var a=this,e=this.$data.global_stage.toDataURL(),t=[],s=[],r=0;r<this.$data.canvasLayers.length;r++)t.push(this.$data.canvasLayers[r].previewStage.toDataURL()),s.push(JSON.parse(this.$data.canvasLayers[r].current_3d_info.cur_vox_info));this.$axios({method:"post",baseURL:"http://localhost:11451",url:"/assembleFromImagesNew",crossDomain:!0,header:{"Access-Control-Allow-Origin":!0},data:{whole_image:e,part_image:t,part_vox:s}}).then((function(e){var t=document.getElementById("threecanvas");t.removeEventListener("mousemove",a.onDocumentMouseMove),t.removeEventListener("dblclick",a.onDoubleClickItem),document.removeEventListener("keydown",a.onChangeTransfromType,!1),a.$data.global_3d_info.cur_mesh=new la["Mesh"](ua.parse(e.data["assembled_model"]),new la["MeshPhongMaterial"]({color:a.$data.mesh_color,flatShading:!0,specular:a.$data.mesh_spec,shininess:100})),a.$data.global_3d_info.cur_mesh_string=e.data["assembled_model"],a.$data.assemble_transform_controls=-1,a.$data.global_3d_info.cur_scene=new la["Scene"];var s=new la["DirectionalLight"](16777215,1.35);s.position.set(1,1,1),a.$data.global_3d_info.cur_scene.add(s),a.$data.global_3d_info.cur_scene.add(new la["HemisphereLight"](4469555,1118498)),a.$data.global_3d_info.cur_scene.add(a.$data.global_3d_info.cur_mesh),a.$data.assemble_mesh_part_list=[];for(var r=0;r<e.data["each_part_mesh"].length;r++)a.$data.assemble_mesh_part_list.push({part_mesh:new la["Mesh"](ua.parse(e.data["each_part_mesh"][r]),new la["MeshPhongMaterial"]({color:a.$data.mesh_color,flatShading:!0,specular:a.$data.mesh_spec,shininess:100})),part_mesh_string:e.data["each_part_mesh"][r]});a.$data.view_mode=0,a.$data.assemble_head_color_type="background:#448aff;height:60px;",a.$data.assemble_head_text="Show The Assembled Model",0==a.$data.show_preview&&(a.$data.show_preview=!0,a.$data.show_sketch=!1,v.$emit("hack:header"))})).catch((function(a){return console.log(a,"error")}))},init_sketch_server:function(){this.$axios({method:"post",baseURL:"http://localhost:11451",url:"/initModel",crossDomain:!0,header:{"Access-Control-Allow-Origin":!0},data:{keyword:"1"}}).then((function(a){console.log(a,"success")})).catch((function(a){return console.log(a,"error")}))},update_part_sketch_models:function(){var a=this;console.log("ask update sketch part models");for(var e=[],t=0;t<this.$data.canvasLayers.length;t++)e.push(this.$data.canvasLayers[t].previewStage.toDataURL());this.$axios({method:"post",baseURL:"http://localhost:11451",url:"/inferAllParts",crossDomain:!0,header:{"Access-Control-Allow-Origin":!0},data:{part_image:e}}).then((function(e){for(var t=0;t<e.data["all_parts"].length;t++)if(a.$data.canvasLayers[t].needsUpdate){a.$data.canvasLayers[t].needsUpdate=!1,a.$data.canvasLayers[t].current_3d_info.cur_vox_info=JSON.stringify(e.data["all_voxes"][t]),a.$data.canvasLayers[t].current_3d_info.cur_mesh=new la["Mesh"](ua.parse(e.data["all_parts"][t]),new la["MeshPhongMaterial"]({color:a.$data.mesh_color,flatShading:!0,specular:a.$data.mesh_spec,shininess:100}));var s=new la["DirectionalLight"](16777215,1.35);s.position.set(1,1,1),a.$data.canvasLayers[t].current_3d_info.cur_scene=new la["Scene"],a.$data.canvasLayers[t].current_3d_info.cur_scene.add(s),a.$data.canvasLayers[t].current_3d_info.cur_scene.add(new la["HemisphereLight"](4469555,1118498)),a.$data.canvasLayers[t].current_3d_info.cur_scene.add(a.$data.canvasLayers[t].current_3d_info.cur_mesh)}})).catch((function(a){return console.log(a,"error")}))},onDoubleClickItem:function(){console.log("current selected part",this.$data.selected_part_to_transform),this.$data.INTERSECTED&&this.$data.selected_part_to_transform!=this.$data.INTERSECTED&&(this.$data.selected_part_to_transform=this.$data.INTERSECTED,this.$data.assemble_transform_controls.detach(),this.$data.assemble_transform_controls.attach(this.$data.selected_part_to_transform))},onSaveCurrentModel:function(){console.log("saveing current model");var a=this.$data.global_3d_info.cur_mesh_string;this.$data.download_link.href=URL.createObjectURL(new Blob([a],{type:"text/plain"})),this.$data.download_link.download="results.ply",this.$data.download_link.click()},onAskChangeModelType:function(){var a=document.URL.split("/"),e=a[a.length-1];e=e.charAt(0).toUpperCase()+e.slice(1),console.log("current model type",e),this.$axios({method:"post",baseURL:"http://localhost:11451",url:"/changeModelType",crossDomain:!0,header:{"Access-Control-Allow-Origin":!0},data:{modelType:e}}).then((function(a){})).catch((function(a){return console.log(a,"error")}))},onChangeTransfromType:function(a){switch(a.keyCode){case 87:this.$data.assemble_transform_controls.setMode("translate");break;case 82:this.$data.assemble_transform_controls.setMode("scale");break}},onDocumentMouseMove:function(a){a.preventDefault();var e=document.getElementById("threecanvas");this.$data.assemble_mouse.x=a.offsetX/e.clientWidth*2-1,this.$data.assemble_mouse.y=-a.offsetY/e.clientHeight*2+1},onChangeViewType:function(){var a=this;if(this.$data.show_preview)if(0==this.$data.view_mode){this.$data.global_3d_info.cur_scene=new la["Scene"];var e=new la["DirectionalLight"](16777215,1.35);e.position.set(1,1,1),this.$data.global_3d_info.cur_scene.add(e),this.$data.global_3d_info.cur_scene.add(new la["HemisphereLight"](4469555,1118498)),this.$data.assemble_mouse=new la["Vector2"],this.$data.assemble_mouse.x=-10,this.$data.assemble_mouse.y=-10,this.$data.assemble_transform_controls=new ma(this.$data.global_3d_info.cur_scene_camera,this.$data.global_3d_info.cur_renderer.domElement),this.$data.assemble_transform_controls.space="local",this.$data.assemble_transform_controls.setSize(2);for(var t=0;t<this.$data.assemble_mesh_part_list.length;t++)this.$data.global_3d_info.cur_scene.add(this.$data.assemble_mesh_part_list[t].part_mesh);this.$data.global_3d_info.cur_scene.add(this.$data.assemble_transform_controls),this.$data.view_mode=1,this.$data.assemble_head_text="Edit the model",this.$data.assemble_head_color_type="background:#0d47a1;height:60px;",this.$data.assemble_recaster=new la["Raycaster"],console.log("change to mode",this.$data.view_mode);var s=document.getElementById("threecanvas");s.addEventListener("mousemove",this.onDocumentMouseMove,!1),s.addEventListener("dblclick",this.onDoubleClickItem,!1),document.addEventListener("keydown",this.onChangeTransfromType,!1)}else if(1==this.$data.view_mode){for(var r=[],i=[],n=[],o=0;o<this.$data.assemble_mesh_part_list.length;o++)i.push([this.$data.assemble_mesh_part_list[o].part_mesh.scale.x,this.$data.assemble_mesh_part_list[o].part_mesh.scale.y,this.$data.assemble_mesh_part_list[o].part_mesh.scale.z]),r.push([this.$data.assemble_mesh_part_list[o].part_mesh.position.x,this.$data.assemble_mesh_part_list[o].part_mesh.position.y,this.$data.assemble_mesh_part_list[o].part_mesh.position.z]),n.push(this.$data.assemble_mesh_part_list[o].part_mesh_string);for(var c=0;c<this.$data.assemble_mesh_part_list.length;c++)console.log(c," ",this.$data.assemble_mesh_part_list[c].part_mesh.scale," ",this.$data.assemble_mesh_part_list[c].part_mesh.position);this.$axios({method:"post",baseURL:"http://localhost:11451",url:"/generateTransformedResults",crossDomain:!0,header:{"Access-Control-Allow-Origin":!0},data:{mesh_string_arr:n,transform_arr:r,scale_arr:i}}).then((function(e){a.$data.view_mode=0,console.log("change to mode",a.$data.view_mode),a.$data.assemble_head_text="Show The Assembled Model",a.$data.assemble_head_color_type="background:#448aff;height:60px;",a.$forceUpdate(),a.$data.assemble_transform_controls=-1;var t=document.getElementById("threecanvas");t.removeEventListener("mousemove",a.onDocumentMouseMove),t.removeEventListener("dblclick",a.onDoubleClickItem),document.removeEventListener("keydown",a.onChangeTransfromType,!1),a.$data.global_3d_info.cur_mesh=new la["Mesh"](ua.parse(e.data["assembled_model"]),new la["MeshPhongMaterial"]({color:a.$data.mesh_color,flatShading:!0,specular:a.$data.mesh_spec,shininess:100})),a.$data.global_3d_info.cur_mesh_string=e.data["assembled_model"],a.$data.assemble_transform_controls=-1,a.$data.global_3d_info.cur_scene=new la["Scene"];var s=new la["DirectionalLight"](16777215,1.35);s.position.set(1,1,1),a.$data.global_3d_info.cur_scene.add(s),a.$data.global_3d_info.cur_scene.add(new la["HemisphereLight"](4469555,1118498)),a.$data.global_3d_info.cur_scene.add(a.$data.global_3d_info.cur_mesh),a.$data.assemble_mesh_part_list=[];for(var r=0;r<e.data["each_part_mesh"].length;r++)a.$data.assemble_mesh_part_list.push({part_mesh:new la["Mesh"](ua.parse(e.data["each_part_mesh"][r]),new la["MeshPhongMaterial"]({color:a.$data.mesh_color,flatShading:!0,specular:1052688,shininess:100})),part_mesh_string:e.data["each_part_mesh"][r]})})).catch((function(a){return console.log(a,"error")}))}}},mounted:function(){var a=this;v.$on("load:images",(function(){a.$data.show_image_uploader=!0})),v.$on("update:changeviewtype",(function(e){var t=!0;t="Sketch"==e,t!=a.$data.show_sketch&&(a.$data.show_sketch=t,a.$data.show_preview=!a.$data.show_sketch)})),this.$data.view_mode=-1,this.clear_canvas_dom(),this.init_sketch_server();var e=na.a.debounce(this.copy_current_layer,1e3),t=na.a.debounce(this.onChangeViewType,1e3),s=na.a.debounce(this.onSaveCurrentModel,1e3),r=na.a.debounce(this.onAskChangeModelType,1e3);this.onAskChangeModelType(),v.$on("update:askPasteCurrentLayer",(function(){e()})),v.$on("update:askChangeViewType",(function(){t()})),v.$on("update:drawingtools",(function(e){a.synBusProps(),a.change_canvas_icon_type(),a.clearTransHandles(),"tool-arrow"==v.current_drawing_tools&&a.updateTransHandles()})),v.$on("update:strokeWidth",(function(e){a.synBusProps()})),v.$on("update:modeltype",r),v.$on("update:askAssembly",(function(){console.log("ask assembly"),a.assemble_parts()})),v.$on("save:current:model",(function(){s()})),v.$on("update:clearChairLayer",(function(){var e=na.a.debounce(a.update_part_sketch_models,100);a.clear_current_layer(),a.clearTransHandles(),"tool-arrow"==v.current_drawing_tools&&a.updateTransHandles(),a.redraw_visable_layers(),a.redraw_preview_layers(),e()})),v.$on("update:addChairLayer",na.a.debounce(this.inner_add_new_layer,200)),v.$on("update:deleteChairLayer",na.a.debounce(this.inner_remove_layer,200)),this.$data.global_stage=new Konva.Stage({container:"maincanvas",width:this.$data.canvas_height,height:this.$data.canvas_width}),this.$data.canvasLayers[0].layer=new Konva.Layer({id:"chair_"+this.$data.canvasLayers[this.$data.canvasLayers.length-1].id.toString()}),this.$data.canvasLayers[0].previewStage=new Konva.Stage({container:"preview-"+this.$data.canvasLayers[0].id.toString(),width:this.$data.preview_width,height:this.$data.preview_height,scaleX:this.$data.preview_width/this.$data.canvas_width,scaleY:this.$data.preview_height/this.$data.canvas_height}),this.$data.canvasLayers[0].transHandle=new Konva.Transformer({keepRatio:!0,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"]}),this.$data.global_stage.add(this.$data.canvasLayers[0].layer),this.$data.global_stage.on("mousedown touchstart",(function(e){a.$data.is_painting=!0;var t=a.$data.global_stage.getPointerPosition();if("tool-brush"==a.$data.cur_brush_type||"tool-eraser"==a.$data.cur_brush_type){for(var s=-1,r=0;r<a.$data.canvasLayers.length;r++)1==a.$data.canvasLayers[r].activated&&(s=r);a.$data.canvasLayers[s].needsUpdate=!0,a.$data.canvasLayers[s].items.push(new Konva.Line({stroke:"black",strokeWidth:a.$data.cur_brush_width,globalCompositeOperation:"tool-brush"===a.$data.cur_brush_type?"source-over":"destination-out",points:[t.x,t.y],draggable:!1})),a.$data.canvasLayers[s].layer.add(a.$data.canvasLayers[s].items[a.$data.canvasLayers[s].items.length-1])}})),this.$data.global_stage.on("mouseup touchend",(function(){var e=na.a.debounce(a.update_part_sketch_models,200);a.$data.is_painting=!1,a.redraw_preview_layers(),e()})),this.$data.global_stage.on("mousemove touchmove",(function(){if(a.$data.is_painting&&("tool-brush"==a.$data.cur_brush_type||"tool-eraser"==a.$data.cur_brush_type)){for(var e=a.$data.global_stage.getPointerPosition(),t=-1,s=0;s<a.$data.canvasLayers.length;s++)1==a.$data.canvasLayers[s].activated&&(t=s);var r=a.$data.canvasLayers[t].items[a.$data.canvasLayers[t].items.length-1].points().concat([e.x,e.y]);a.$data.canvasLayers[t].items[a.$data.canvasLayers[t].items.length-1].points(r),a.redraw_visable_layers()}}));var i=512,n=512,o=document.getElementById("threecanvas");this.$data.global_3d_info.cur_scene_camera=new la["PerspectiveCamera"](70,i/n,.01,10),this.$data.global_3d_info.cur_scene_camera.position.z=1,this.$data.global_3d_info.cur_scene=new la["Scene"],this.$data.global_3d_info.cur_renderer=new la["WebGLRenderer"]({antialias:!0}),this.$data.global_3d_info.cur_renderer.setSize(i,n),this.$data.global_3d_info.cur_renderer.setClearColor(16777215,1),this.$data.global_3d_info.cur_scene_control=new pa(this.$data.global_3d_info.cur_scene_camera,this.$data.global_3d_info.cur_renderer.domElement),this.$data.global_3d_info.cur_scene_control.rotateSpeed=1,this.$data.global_3d_info.cur_scene_control.zoomSpeed=1.2,this.$data.global_3d_info.cur_scene_control.panSpeed=.8,this.$data.global_3d_info.cur_scene_control.enabled=!0,this.$data.global_3d_info.cur_scene_control.enableRotate=!0,this.$data.global_3d_info.cur_scene_control.enableZoom=!0,o.appendChild(this.$data.global_3d_info.cur_renderer.domElement),this.$data.download_link=document.createElement("a"),this.$data.download_link.style.display="none",document.body.appendChild(this.$data.download_link),this.$data.three_clock=new la["Clock"],this.check_model_preview(),this.redraw_global_scene()}},fa=va,ga=(t("b9b1"),Object(l["a"])(fa,ta,sa,!1,null,"7437975f",null)),ya=ga.exports,$a=function(){var a=this,e=a.$createElement;a._self._c;return a._m(0)},ba=[function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"content"},[t("div",{staticClass:"md-layout"},[t("div",{staticClass:"md-layout-item md-medium-size-100 md-xsmall-size-100 md-size-33"})])])}],wa={components:{},data:function(){return{cur_brush_width:5,cur_brush_type:"tool-brush"}},mounted:function(){}},La=wa,xa=Object(l["a"])(La,$a,ba,!1,null,null,null),ka=(xa.exports,function(){var a=this,e=a.$createElement;a._self._c;return a._m(0)}),Ca=[function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"content"},[t("div",{staticClass:"md-layout"},[t("div",{staticClass:"md-layout-item md-medium-size-100 md-xsmall-size-100 md-size-33"})])])}],Sa={components:{},data:function(){return{cur_brush_width:5,cur_brush_type:"tool-brush"}},mounted:function(){}},Ta=Sa,Ea=Object(l["a"])(Ta,ka,Ca,!1,null,null,null),Da=(Ea.exports,[{path:"/",component:ea,redirect:"/chair",children:[{path:"chair",name:"Chair Modeling",disable:!1,component:ya},{path:"lamp",name:"Lamp Modeling",disable:!1,component:ya},{path:"table",name:"Table Modeling",disable:!1,component:ya}]}]),Oa=Da,Ma=t("6f9a"),Aa=t.n(Ma),Ha=t("25e5"),Ia=t.n(Ha),Na=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:a.closeDropDown,expression:"closeDropDown"}],staticClass:"dropdown",class:{open:a.isOpen},on:{click:a.toggleDropDown}},[a._t("title",[t("a",{staticClass:"dropdown-toggle",attrs:{"data-toggle":"dropdown",href:"javascript:void(0)"}},[t("i",{class:a.icon}),t("p",{staticClass:"notification"},[a._v(" "+a._s(a.title)+" "),t("b",{staticClass:"caret"})])])]),a._t("default")],2)},ja=[],Pa={name:"drop-down",props:{title:String,icon:String},data:function(){return{isOpen:!1}},methods:{toggleDropDown:function(){this.isOpen=!this.isOpen},closeDropDown:function(){this.isOpen=!1}}},Ra=Pa,Ua=Object(l["a"])(Ra,Na,ja,!1,null,null,null),za=Ua.exports,Wa={install:function(a){a.component("drop-down",za)}},Ba=Wa,Ka=t("a3cf"),Va={install:function(a){a.directive("click-outside",Ka["directive"])}},Fa=Va,Ja=(t("33c4"),function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"notifications"},[t("transition-group",{attrs:{name:"list"}},a._l(a.notifications,(function(e){return t("notification",{key:e.timestamp.getTime(),attrs:{message:e.message,icon:e.icon,type:e.type,timestamp:e.timestamp,"vertical-align":e.verticalAlign,"horizontal-align":e.horizontalAlign},on:{"on-close":a.removeNotification}})})),1)],1)}),Ya=[],qa=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"alert open alert-with-icon",class:[a.verticalAlign,a.horizontalAlign,a.alertType],style:a.customPosition,attrs:{"data-notify":"container",role:"alert","data-notify-position":"top-center"},on:{click:function(e){return a.close()}}},[t("button",{staticClass:"close",attrs:{type:"button","aria-hidden":"true","data-notify":"dismiss"},on:{click:a.close}},[a._v(" Ã ")]),t("i",{staticClass:"material-icons",attrs:{"data-notify":"icon"}},[a._v(a._s(a.icon))]),t("span",{attrs:{"data-notify":"message"},domProps:{innerHTML:a._s(a.message)}})])},Ga=[],Xa=(t("86dd"),t("f4a0"),{name:"notification",props:{message:String,icon:String,verticalAlign:{type:String,default:"top"},horizontalAlign:{type:String,default:"center"},type:{type:String,default:"info"},timeout:{type:Number,default:2500},timestamp:{type:Date,default:function(){return new Date}}},data:function(){return{elmHeight:0}},computed:{hasIcon:function(){return this.icon&&this.icon.length>0},alertType:function(){return"alert-".concat(this.type)},customPosition:function(){var a=this,e=20,t=this.elmHeight+10,s=this.$notifications.state.filter((function(e){return e.horizontalAlign===a.horizontalAlign&&e.verticalAlign===a.verticalAlign&&e.timestamp<=a.timestamp})).length,r=(s-1)*t+e,i={};return"top"===this.verticalAlign?i.top="".concat(r,"px"):i.bottom="".concat(r,"px"),i}},methods:{close:function(){this.$emit("on-close",this.timestamp)}},mounted:function(){this.elmHeight=this.$el.clientHeight,this.timeout&&setTimeout(this.close,this.timeout)}}),Za=Xa,Qa=(t("7b35"),Object(l["a"])(Za,qa,Ga,!1,null,"3b98be06",null)),ae=Qa.exports,ee={components:{Notification:ae},data:function(){return{notifications:this.$notifications.state}},methods:{removeNotification:function(a){this.$notifications.removeNotification(a)}}},te=ee,se=(t("6ae5"),Object(l["a"])(te,Ja,Ya,!1,null,null,null)),re=se.exports,ie={state:[],removeNotification:function(a){var e=this.state.findIndex((function(e){return e.timestamp===a}));-1!==e&&this.state.splice(e,1)},addNotification:function(a){a.timestamp=new Date,a.timestamp.setMilliseconds(a.timestamp.getMilliseconds()+this.state.length),this.state.push(a)},notify:function(a){var e=this;Array.isArray(a)?a.forEach((function(a){e.addNotification(a)})):this.addNotification(a)}},ne={install:function(a){a.mixin({data:function(){return{notificationStore:ie}},methods:{notify:function(a){this.notificationStore.notify(a)}}}),Object.defineProperty(a.prototype,"$notify",{get:function(){return this.$root.notify}}),Object.defineProperty(a.prototype,"$notifications",{get:function(){return this.$root.notificationStore}}),a.component("Notifications",re)}},oe=ne,ce=t("82ae"),le=t.n(ce),de=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticStyle:{height:"100%",overflow:"hidden !important",background:"#010101 !important",opacity:"1 !important","border-right":"1px #252525 solid",width:"70px",position:"absolute"}},[t("div",{staticStyle:{"background-color":"#010101 !important",top:"margin-top:100px"}},[t("div",{staticStyle:{height:"70px"}}),a._l(a.selectedTools,(function(e){return t("div",{key:e.type,staticClass:"sidebar-tools",class:[{active:e.active}],on:{click:function(t){return a.changeDrawingTools(e.type)}}},[t("i",{class:""+e.iconName,staticStyle:{"margin-top":"20px"}})])})),t("div",{staticClass:"sidebar-tools",staticStyle:{"margin-top":"10px"},on:{click:a.add_new_layer}},[t("i",{staticClass:"material-icons",staticStyle:{"margin-top":"20px"}},[a._v("add")])]),t("div",{staticClass:"sidebar-tools",on:{click:a.clear_current_layer}},[t("i",{staticClass:"material-icons",staticStyle:{"margin-top":"20px"}},[a._v("layers_clear")])]),t("div",{staticClass:"sidebar-tools",on:{click:a.askCopyCurrentLayer}},[t("i",{staticClass:"material-icons",staticStyle:{"margin-top":"20px"}},[a._v("content_paste")])]),t("div",{staticClass:"sidebar-tools",on:{click:a.delete_current_layer}},[t("i",{staticClass:"material-icons",staticStyle:{"margin-top":"20px"}},[a._v("delete")])]),t("div",{staticClass:"sidebar-tools",on:{click:a.askAssembly}},[t("i",{staticClass:"material-icons",staticStyle:{"margin-top":"20px"}},[a._v("dynamic_feed")])]),t("div",{staticClass:"sidebar-tools",on:{click:a.askChangeViewType}},[t("i",{staticClass:"material-icons",staticStyle:{"margin-top":"20px"}},[a._v("edit")])]),t("div",{staticClass:"sidebar-tools",on:{click:a.ask_load_image_to_current_layer}},[t("i",{staticClass:"material-icons",staticStyle:{"margin-top":"20px"}},[a._v("cloud_upload")])])],2)])},he=[],_e=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("li",{staticClass:"md-list-item"},[t("router-link",a._b({staticClass:"md-list-item-router md-list-item-container md-button-clean",nativeOn:{click:function(e){return a.changeModelType(a.$attrs)}}},"router-link",a.$attrs,!1),[t("div",{staticClass:"md-list-item-content md-ripple"},[a._t("default",[t("md-icon",[a._v(a._s(a.link.icon))]),t("p",[a._v(a._s(a.link.name))])])],2)])],1)},ue=[],pe={inject:{autoClose:{default:!0}},props:{link:{type:[String,Object],default:function(){return{name:"",path:"",icon:""}}},tag:{type:String,default:"router-link"}},methods:{hideSidebar:function(){this.autoClose&&this.$sidebar&&!0===this.$sidebar.showSidebar&&this.$sidebar.displaySidebar(!1)},changeModelType:function(a){console.log("ask change model type",a.to),v.$emit("update:modeltype")}}},me=pe,ve=Object(l["a"])(me,_e,ue,!1,null,null,null),fe=ve.exports,ge={components:{SidebarLink:fe},data:function(){return{strokeWidth:4,currentToolId:0,selectedTools:[{type:"tool-arrow",active:!0,iconName:"fa fa-mouse-pointer fa-2x"},{type:"tool-brush",active:!1,iconName:"fa fa-paint-brush fa-2x"},{type:"tool-eraser",active:!1,iconName:"fa fa-eraser fa-2x"}]}},props:{title:{type:String,default:"Smart Sketch"}},provide:function(){return{autoClose:this.autoClose}},methods:{changeDrawingTools:function(a){for(var e=0;e<this.selectedTools.length;e++)this.selectedTools[e].type===a?(this.selectedTools[e].active=!0,this.$data.currentToolId=e):this.selectedTools[e].active=!1;v.$data.current_drawing_tools=a,v.$emit("update:drawingtools",a)},ask_load_image_to_current_layer:function(){console.log("ask load images"),v.$emit("load:images")},clear_current_layer:function(){v.$emit("update:clearChairLayer")},add_new_layer:function(){v.$emit("update:addChairLayer")},delete_current_layer:function(){v.$emit("update:deleteChairLayer")},save_current_model:function(){v.$emit("save:current:model")},askCopyCurrentLayer:function(){v.$emit("update:askPasteCurrentLayer")},askChangeViewType:function(){v.$emit("update:askChangeViewType")},askAssembly:function(){v.$emit("update:askAssembly")}},mounted:function(){var a=this;v.$on("hack:updatebrush",(function(){a.$data.currentToolId=0,a.$data.selectedTools[0].active=!0,a.$data.selectedTools[1].active=!1,a.$data.selectedTools[2].active=!1,v.$data.current_drawing_tools=a.$data.selectedTools[0].type,v.$emit("update:drawingtools",a.$data.selectedTools[0].type)}))}},ye=ge,$e=(t("4656"),Object(l["a"])(ye,de,he,!1,null,null,null)),be=$e.exports,we={showSidebar:!1,displaySidebar:function(a){this.showSidebar=a}},Le={install:function(a){a.mixin({data:function(){return{sidebarStore:we}}}),Object.defineProperty(a.prototype,"$sidebar",{get:function(){return this.$root.sidebarStore}}),a.component("side-bar",be),a.component("sidebar-link",fe)}},xe=Le,ke=(t("19d3"),t("9e17"),t("470c"),{install:function(a){a.use(xe),a.use(Ia.a)}}),Ce=t("c99d"),Se=t.n(Ce),Te=t("b705"),Ee=t.n(Te);t("3880");s["default"].prototype.$axios=le.a;var De=new r["a"]({routes:Oa,linkExactActiveClass:"nav-item active"});s["default"].prototype.$Chartist=Se.a,s["default"].config.productionTip=!1,s["default"].use(Ee.a),s["default"].use(r["a"]),s["default"].use(ke),s["default"].use(Ba),s["default"].use(Fa),s["default"].use(oe),s["default"].use(Aa.a),s["default"].use(Ia.a),new s["default"]({el:"#app",render:function(a){return a(h)},router:De,data:{Chartist:Se.a}})},"6aa0":function(a,e,t){},"6ae5":function(a,e,t){"use strict";var s=t("2c7f"),r=t.n(s);r.a},"7b35":function(a,e,t){"use strict";var s=t("f5cf"),r=t.n(s);r.a},"9e17":function(a,e,t){},b3ce:function(a,e,t){},b9b1:function(a,e,t){"use strict";var s=t("3bfe"),r=t.n(s);r.a},b9eb:function(a,e,t){},d903:function(a,e,t){"use strict";var s=t("6aa0"),r=t.n(s);r.a},dac3:function(a,e,t){"use strict";var s=t("b9eb"),r=t.n(s);r.a},f5cf:function(a,e,t){},f8ac:function(a,e,t){}});
//# sourceMappingURL=app.63e18d48.js.map